{"ast":null,"code":"var _jsxFileName = \"D:\\\\Personal_Projects\\\\Vehicle Tracking\\\\Development2.0\\\\JFRD-ULTRAKER\\\\traccar-web\\\\modern\\\\src\\\\reports\\\\TripReportPage.js\";\nimport React, { useState } from 'react';\nimport { DataGrid } from '@material-ui/data-grid';\nimport { useTheme } from '@material-ui/core/styles';\nimport { formatDistance, formatSpeed, formatHours, formatDate, formatVolume } from '../common/formatter';\nimport ReportFilter from './ReportFilter';\nimport ReportLayout from './ReportLayout';\nimport { useAttributePreference } from '../common/preferences';\nimport t from '../common/localization';\n\nconst Filter = _ref => {\n  let {\n    setItems\n  } = _ref;\n\n  const handleSubmit = async (deviceId, from, to, mail, headers) => {\n    const query = new URLSearchParams({\n      deviceId,\n      from,\n      to,\n      mail\n    });\n    const response = await fetch(`/api/reports/trips?${query.toString()}`, {\n      headers\n    });\n\n    if (response.ok) {\n      const contentType = response.headers.get('content-type');\n\n      if (contentType) {\n        if (contentType === 'application/json') {\n          setItems(await response.json());\n        } else {\n          window.location.assign(window.URL.createObjectURL(await response.blob()));\n        }\n      }\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(ReportFilter, {\n    handleSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 10\n    }\n  });\n};\n\nconst TripReportPage = () => {\n  const theme = useTheme();\n  const distanceUnit = useAttributePreference('distanceUnit');\n  const speedUnit = useAttributePreference('speedUnit');\n  const volumeUnit = useAttributePreference('volumeUnit');\n  const [items, setItems] = useState([]);\n  const columns = [{\n    headerName: t('reportStartTime'),\n    field: 'startTime',\n    type: 'dateTime',\n    width: theme.dimensions.columnWidthDate,\n    valueFormatter: _ref2 => {\n      let {\n        value\n      } = _ref2;\n      return formatDate(value);\n    }\n  }, {\n    headerName: t('reportStartOdometer'),\n    field: 'startOdometer',\n    type: 'number',\n    width: theme.dimensions.columnWidthNumber,\n    valueFormatter: _ref3 => {\n      let {\n        value\n      } = _ref3;\n      return formatDistance(value, distanceUnit);\n    }\n  }, {\n    headerName: t('reportStartAddress'),\n    field: 'startAddress',\n    type: 'string',\n    hide: true,\n    width: theme.dimensions.columnWidthString\n  }, {\n    headerName: t('reportEndTime'),\n    field: 'endTime',\n    type: 'dateTime',\n    width: theme.dimensions.columnWidthDate,\n    valueFormatter: _ref4 => {\n      let {\n        value\n      } = _ref4;\n      return formatDate(value);\n    }\n  }, {\n    headerName: t('reportEndOdometer'),\n    field: 'endOdometer',\n    type: 'number',\n    width: theme.dimensions.columnWidthNumber,\n    valueFormatter: _ref5 => {\n      let {\n        value\n      } = _ref5;\n      return formatDistance(value, distanceUnit);\n    }\n  }, {\n    headerName: t('reportEndAddress'),\n    field: 'endAddress',\n    type: 'string',\n    hide: true,\n    width: theme.dimensions.columnWidthString\n  }, {\n    headerName: t('sharedDistance'),\n    field: 'distance',\n    type: 'number',\n    width: theme.dimensions.columnWidthNumber,\n    valueFormatter: _ref6 => {\n      let {\n        value\n      } = _ref6;\n      return formatDistance(value, distanceUnit);\n    }\n  }, {\n    headerName: t('reportAverageSpeed'),\n    field: 'averageSpeed',\n    type: 'number',\n    width: theme.dimensions.columnWidthNumber,\n    valueFormatter: _ref7 => {\n      let {\n        value\n      } = _ref7;\n      return formatSpeed(value, speedUnit);\n    }\n  }, {\n    headerName: t('reportMaximumSpeed'),\n    field: 'maxSpeed',\n    type: 'number',\n    width: theme.dimensions.columnWidthNumber,\n    valueFormatter: _ref8 => {\n      let {\n        value\n      } = _ref8;\n      return formatSpeed(value, speedUnit);\n    }\n  }, {\n    headerName: t('reportDuration'),\n    field: 'duration',\n    type: 'string',\n    width: theme.dimensions.columnWidthString,\n    valueFormatter: _ref9 => {\n      let {\n        value\n      } = _ref9;\n      return formatHours(value);\n    }\n  }, {\n    headerName: t('reportSpentFuel'),\n    field: 'spentFuel',\n    type: 'number',\n    width: theme.dimensions.columnWidthNumber,\n    hide: true,\n    valueFormatter: _ref10 => {\n      let {\n        value\n      } = _ref10;\n      return formatVolume(value, volumeUnit);\n    }\n  }, {\n    headerName: t('sharedDriver'),\n    field: 'driverName',\n    type: 'string',\n    width: theme.dimensions.columnWidthString,\n    hide: true\n  }];\n  return /*#__PURE__*/React.createElement(ReportLayout, {\n    filter: /*#__PURE__*/React.createElement(Filter, {\n      setItems: setItems,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 27\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(DataGrid, {\n    rows: items,\n    columns: columns,\n    hideFooter: true,\n    autoHeight: true,\n    getRowId: () => Math.random(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default TripReportPage;","map":{"version":3,"sources":["D:/Personal_Projects/Vehicle Tracking/Development2.0/JFRD-ULTRAKER/traccar-web/modern/src/reports/TripReportPage.js"],"names":["React","useState","DataGrid","useTheme","formatDistance","formatSpeed","formatHours","formatDate","formatVolume","ReportFilter","ReportLayout","useAttributePreference","t","Filter","setItems","handleSubmit","deviceId","from","to","mail","headers","query","URLSearchParams","response","fetch","toString","ok","contentType","get","json","window","location","assign","URL","createObjectURL","blob","TripReportPage","theme","distanceUnit","speedUnit","volumeUnit","items","columns","headerName","field","type","width","dimensions","columnWidthDate","valueFormatter","value","columnWidthNumber","hide","columnWidthString","Math","random"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport { DataGrid } from '@material-ui/data-grid';\r\nimport { useTheme } from '@material-ui/core/styles';\r\nimport {\r\n  formatDistance, formatSpeed, formatHours, formatDate, formatVolume,\r\n} from '../common/formatter';\r\nimport ReportFilter from './ReportFilter';\r\nimport ReportLayout from './ReportLayout';\r\nimport { useAttributePreference } from '../common/preferences';\r\nimport t from '../common/localization';\r\n\r\nconst Filter = ({ setItems }) => {\r\n  const handleSubmit = async (deviceId, from, to, mail, headers) => {\r\n    const query = new URLSearchParams({\r\n      deviceId, from, to, mail,\r\n    });\r\n    const response = await fetch(`/api/reports/trips?${query.toString()}`, { headers });\r\n    if (response.ok) {\r\n      const contentType = response.headers.get('content-type');\r\n      if (contentType) {\r\n        if (contentType === 'application/json') {\r\n          setItems(await response.json());\r\n        } else {\r\n          window.location.assign(window.URL.createObjectURL(await response.blob()));\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  return <ReportFilter handleSubmit={handleSubmit} />;\r\n};\r\n\r\nconst TripReportPage = () => {\r\n  const theme = useTheme();\r\n\r\n  const distanceUnit = useAttributePreference('distanceUnit');\r\n  const speedUnit = useAttributePreference('speedUnit');\r\n  const volumeUnit = useAttributePreference('volumeUnit');\r\n\r\n  const [items, setItems] = useState([]);\r\n\r\n  const columns = [{\r\n    headerName: t('reportStartTime'),\r\n    field: 'startTime',\r\n    type: 'dateTime',\r\n    width: theme.dimensions.columnWidthDate,\r\n    valueFormatter: ({ value }) => formatDate(value),\r\n  }, {\r\n    headerName: t('reportStartOdometer'),\r\n    field: 'startOdometer',\r\n    type: 'number',\r\n    width: theme.dimensions.columnWidthNumber,\r\n    valueFormatter: ({ value }) => formatDistance(value, distanceUnit),\r\n  }, {\r\n    headerName: t('reportStartAddress'),\r\n    field: 'startAddress',\r\n    type: 'string',\r\n    hide: true,\r\n    width: theme.dimensions.columnWidthString,\r\n  }, {\r\n    headerName: t('reportEndTime'),\r\n    field: 'endTime',\r\n    type: 'dateTime',\r\n    width: theme.dimensions.columnWidthDate,\r\n    valueFormatter: ({ value }) => formatDate(value),\r\n  }, {\r\n    headerName: t('reportEndOdometer'),\r\n    field: 'endOdometer',\r\n    type: 'number',\r\n    width: theme.dimensions.columnWidthNumber,\r\n    valueFormatter: ({ value }) => formatDistance(value, distanceUnit),\r\n  }, {\r\n    headerName: t('reportEndAddress'),\r\n    field: 'endAddress',\r\n    type: 'string',\r\n    hide: true,\r\n    width: theme.dimensions.columnWidthString,\r\n  }, {\r\n    headerName: t('sharedDistance'),\r\n    field: 'distance',\r\n    type: 'number',\r\n    width: theme.dimensions.columnWidthNumber,\r\n    valueFormatter: ({ value }) => formatDistance(value, distanceUnit),\r\n  }, {\r\n    headerName: t('reportAverageSpeed'),\r\n    field: 'averageSpeed',\r\n    type: 'number',\r\n    width: theme.dimensions.columnWidthNumber,\r\n    valueFormatter: ({ value }) => formatSpeed(value, speedUnit),\r\n  }, {\r\n    headerName: t('reportMaximumSpeed'),\r\n    field: 'maxSpeed',\r\n    type: 'number',\r\n    width: theme.dimensions.columnWidthNumber,\r\n    valueFormatter: ({ value }) => formatSpeed(value, speedUnit),\r\n  }, {\r\n    headerName: t('reportDuration'),\r\n    field: 'duration',\r\n    type: 'string',\r\n    width: theme.dimensions.columnWidthString,\r\n    valueFormatter: ({ value }) => formatHours(value),\r\n  }, {\r\n    headerName: t('reportSpentFuel'),\r\n    field: 'spentFuel',\r\n    type: 'number',\r\n    width: theme.dimensions.columnWidthNumber,\r\n    hide: true,\r\n    valueFormatter: ({ value }) => formatVolume(value, volumeUnit),\r\n  }, {\r\n    headerName: t('sharedDriver'),\r\n    field: 'driverName',\r\n    type: 'string',\r\n    width: theme.dimensions.columnWidthString,\r\n    hide: true,\r\n  }];\r\n\r\n  return (\r\n    <ReportLayout filter={<Filter setItems={setItems} />}>\r\n      <DataGrid\r\n        rows={items}\r\n        columns={columns}\r\n        hideFooter\r\n        autoHeight\r\n        getRowId={() => Math.random()}\r\n      />\r\n    </ReportLayout>\r\n  );\r\n};\r\n\r\nexport default TripReportPage;\r\n"]},"metadata":{},"sourceType":"module"}