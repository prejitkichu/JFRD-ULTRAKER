{"ast":null,"code":"var _jsxFileName = \"D:\\\\Personal_Projects\\\\Vehicle Tracking\\\\Development2.0\\\\JFRD-ULTRAKER\\\\traccar-web\\\\modern\\\\src\\\\reports\\\\SummaryReportPage.js\";\nimport React, { useState } from 'react';\nimport { DataGrid } from '@material-ui/data-grid';\nimport { Grid, FormControlLabel, Checkbox } from '@material-ui/core';\nimport { useTheme } from '@material-ui/core/styles';\nimport { formatDistance, formatHours, formatDate, formatSpeed, formatVolume } from '../common/formatter';\nimport ReportFilter from './ReportFilter';\nimport ReportLayout from './ReportLayout';\nimport { useAttributePreference } from '../common/preferences';\nimport t from '../common/localization';\n\nconst Filter = _ref => {\n  let {\n    setItems\n  } = _ref;\n  const [daily, setDaily] = useState(false);\n\n  const handleSubmit = async (deviceId, from, to, mail, headers) => {\n    const query = new URLSearchParams({\n      deviceId,\n      from,\n      to,\n      daily,\n      mail\n    });\n    const response = await fetch(`/api/reports/summary?${query.toString()}`, {\n      headers\n    });\n\n    if (response.ok) {\n      const contentType = response.headers.get('content-type');\n\n      if (contentType) {\n        if (contentType === 'application/json') {\n          setItems(await response.json());\n        } else {\n          window.location.assign(window.URL.createObjectURL(await response.blob()));\n        }\n      }\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(ReportFilter, {\n    handleSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(FormControlLabel, {\n    control: /*#__PURE__*/React.createElement(Checkbox, {\n      checked: daily,\n      onChange: e => setDaily(e.target.checked),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 20\n      }\n    }),\n    label: t('reportDaily'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 9\n    }\n  })));\n};\n\nconst SummaryReportPage = () => {\n  const theme = useTheme();\n  const distanceUnit = useAttributePreference('distanceUnit');\n  const speedUnit = useAttributePreference('speedUnit');\n  const volumeUnit = useAttributePreference('volumeUnit');\n  const [items, setItems] = useState([]);\n  const columns = [{\n    headerName: t('reportStartDate'),\n    field: 'startTime',\n    type: 'dateTime',\n    width: theme.dimensions.columnWidthDate,\n    valueFormatter: _ref2 => {\n      let {\n        value\n      } = _ref2;\n      return formatDate(value, 'YYYY-MM-DD');\n    }\n  }, {\n    headerName: t('sharedDistance'),\n    field: 'distance',\n    type: 'number',\n    width: theme.dimensions.columnWidthNumber,\n    valueFormatter: _ref3 => {\n      let {\n        value\n      } = _ref3;\n      return formatDistance(value, distanceUnit);\n    }\n  }, {\n    headerName: t('reportStartOdometer'),\n    field: 'startOdometer',\n    type: 'number',\n    width: theme.dimensions.columnWidthNumber,\n    valueFormatter: _ref4 => {\n      let {\n        value\n      } = _ref4;\n      return formatDistance(value, distanceUnit);\n    }\n  }, {\n    headerName: t('reportEndOdometer'),\n    field: 'endOdometer',\n    type: 'number',\n    width: theme.dimensions.columnWidthNumber,\n    valueFormatter: _ref5 => {\n      let {\n        value\n      } = _ref5;\n      return formatDistance(value, distanceUnit);\n    }\n  }, {\n    headerName: t('reportAverageSpeed'),\n    field: 'averageSpeed',\n    type: 'number',\n    width: theme.dimensions.columnWidthNumber,\n    valueFormatter: _ref6 => {\n      let {\n        value\n      } = _ref6;\n      return formatSpeed(value, speedUnit);\n    }\n  }, {\n    headerName: t('reportMaximumSpeed'),\n    field: 'maxSpeed',\n    type: 'number',\n    width: theme.dimensions.columnWidthNumber,\n    valueFormatter: _ref7 => {\n      let {\n        value\n      } = _ref7;\n      return formatSpeed(value, speedUnit);\n    }\n  }, {\n    headerName: t('reportEngineHours'),\n    field: 'engineHours',\n    type: 'string',\n    width: theme.dimensions.columnWidthNumber,\n    valueFormatter: _ref8 => {\n      let {\n        value\n      } = _ref8;\n      return formatHours(value);\n    }\n  }, {\n    headerName: t('reportSpentFuel'),\n    field: 'spentFuel',\n    type: 'number',\n    width: theme.dimensions.columnWidthNumber,\n    hide: true,\n    valueFormatter: _ref9 => {\n      let {\n        value\n      } = _ref9;\n      return formatVolume(value, volumeUnit);\n    }\n  }];\n  return /*#__PURE__*/React.createElement(ReportLayout, {\n    filter: /*#__PURE__*/React.createElement(Filter, {\n      setItems: setItems,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 27\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(DataGrid, {\n    rows: items,\n    columns: columns,\n    hideFooter: true,\n    autoHeight: true,\n    getRowId: () => Math.random(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default SummaryReportPage;","map":{"version":3,"sources":["D:/Personal_Projects/Vehicle Tracking/Development2.0/JFRD-ULTRAKER/traccar-web/modern/src/reports/SummaryReportPage.js"],"names":["React","useState","DataGrid","Grid","FormControlLabel","Checkbox","useTheme","formatDistance","formatHours","formatDate","formatSpeed","formatVolume","ReportFilter","ReportLayout","useAttributePreference","t","Filter","setItems","daily","setDaily","handleSubmit","deviceId","from","to","mail","headers","query","URLSearchParams","response","fetch","toString","ok","contentType","get","json","window","location","assign","URL","createObjectURL","blob","e","target","checked","SummaryReportPage","theme","distanceUnit","speedUnit","volumeUnit","items","columns","headerName","field","type","width","dimensions","columnWidthDate","valueFormatter","value","columnWidthNumber","hide","Math","random"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport { DataGrid } from '@material-ui/data-grid';\r\nimport { Grid, FormControlLabel, Checkbox } from '@material-ui/core';\r\nimport { useTheme } from '@material-ui/core/styles';\r\nimport {\r\n  formatDistance, formatHours, formatDate, formatSpeed, formatVolume,\r\n} from '../common/formatter';\r\nimport ReportFilter from './ReportFilter';\r\nimport ReportLayout from './ReportLayout';\r\nimport { useAttributePreference } from '../common/preferences';\r\nimport t from '../common/localization';\r\n\r\nconst Filter = ({ setItems }) => {\r\n  const [daily, setDaily] = useState(false);\r\n\r\n  const handleSubmit = async (deviceId, from, to, mail, headers) => {\r\n    const query = new URLSearchParams({\r\n      deviceId, from, to, daily, mail,\r\n    });\r\n    const response = await fetch(`/api/reports/summary?${query.toString()}`, { headers });\r\n    if (response.ok) {\r\n      const contentType = response.headers.get('content-type');\r\n      if (contentType) {\r\n        if (contentType === 'application/json') {\r\n          setItems(await response.json());\r\n        } else {\r\n          window.location.assign(window.URL.createObjectURL(await response.blob()));\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ReportFilter handleSubmit={handleSubmit}>\r\n      <Grid item xs={12} sm={6}>\r\n        <FormControlLabel\r\n          control={<Checkbox checked={daily} onChange={(e) => setDaily(e.target.checked)} />}\r\n          label={t('reportDaily')}\r\n        />\r\n      </Grid>\r\n    </ReportFilter>\r\n  );\r\n};\r\n\r\nconst SummaryReportPage = () => {\r\n  const theme = useTheme();\r\n\r\n  const distanceUnit = useAttributePreference('distanceUnit');\r\n  const speedUnit = useAttributePreference('speedUnit');\r\n  const volumeUnit = useAttributePreference('volumeUnit');\r\n\r\n  const [items, setItems] = useState([]);\r\n\r\n  const columns = [{\r\n    headerName: t('reportStartDate'),\r\n    field: 'startTime',\r\n    type: 'dateTime',\r\n    width: theme.dimensions.columnWidthDate,\r\n    valueFormatter: ({ value }) => formatDate(value, 'YYYY-MM-DD'),\r\n  }, {\r\n    headerName: t('sharedDistance'),\r\n    field: 'distance',\r\n    type: 'number',\r\n    width: theme.dimensions.columnWidthNumber,\r\n    valueFormatter: ({ value }) => formatDistance(value, distanceUnit),\r\n  }, {\r\n    headerName: t('reportStartOdometer'),\r\n    field: 'startOdometer',\r\n    type: 'number',\r\n    width: theme.dimensions.columnWidthNumber,\r\n    valueFormatter: ({ value }) => formatDistance(value, distanceUnit),\r\n  }, {\r\n    headerName: t('reportEndOdometer'),\r\n    field: 'endOdometer',\r\n    type: 'number',\r\n    width: theme.dimensions.columnWidthNumber,\r\n    valueFormatter: ({ value }) => formatDistance(value, distanceUnit),\r\n  }, {\r\n    headerName: t('reportAverageSpeed'),\r\n    field: 'averageSpeed',\r\n    type: 'number',\r\n    width: theme.dimensions.columnWidthNumber,\r\n    valueFormatter: ({ value }) => formatSpeed(value, speedUnit),\r\n  }, {\r\n    headerName: t('reportMaximumSpeed'),\r\n    field: 'maxSpeed',\r\n    type: 'number',\r\n    width: theme.dimensions.columnWidthNumber,\r\n    valueFormatter: ({ value }) => formatSpeed(value, speedUnit),\r\n  }, {\r\n    headerName: t('reportEngineHours'),\r\n    field: 'engineHours',\r\n    type: 'string',\r\n    width: theme.dimensions.columnWidthNumber,\r\n    valueFormatter: ({ value }) => formatHours(value),\r\n  }, {\r\n    headerName: t('reportSpentFuel'),\r\n    field: 'spentFuel',\r\n    type: 'number',\r\n    width: theme.dimensions.columnWidthNumber,\r\n    hide: true,\r\n    valueFormatter: ({ value }) => formatVolume(value, volumeUnit),\r\n  }];\r\n\r\n  return (\r\n    <ReportLayout filter={<Filter setItems={setItems} />}>\r\n      <DataGrid\r\n        rows={items}\r\n        columns={columns}\r\n        hideFooter\r\n        autoHeight\r\n        getRowId={() => Math.random()}\r\n      />\r\n    </ReportLayout>\r\n  );\r\n};\r\n\r\nexport default SummaryReportPage;\r\n"]},"metadata":{},"sourceType":"module"}