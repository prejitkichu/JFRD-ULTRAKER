{"ast":null,"code":"var _jsxFileName = \"D:\\\\Personal_Projects\\\\Vehicle Tracking\\\\Development2.0\\\\JFRD-ULTRAKER\\\\traccar-web\\\\modern\\\\src\\\\admin\\\\StatisticsPage.js\";\nimport React, { useState } from 'react';\nimport { FormControl, InputLabel, Select, MenuItem, TextField, Button, TableContainer, Table, TableRow, TableCell, TableHead, TableBody, Paper } from '@material-ui/core';\nimport moment from 'moment';\nimport t from '../common/localization';\nimport { formatDate } from '../common/formatter';\nimport OptionsLayout from '../settings/OptionsLayout';\n\nconst Filter = _ref => {\n  let {\n    setItems\n  } = _ref;\n  const [period, setPeriod] = useState('today');\n  const [from, setFrom] = useState(moment().subtract(1, 'hour'));\n  const [to, setTo] = useState(moment());\n\n  const handleClick = async () => {\n    let selectedFrom;\n    let selectedTo;\n\n    switch (period) {\n      case 'today':\n        selectedFrom = moment().startOf('day');\n        selectedTo = moment().endOf('day');\n        break;\n\n      case 'yesterday':\n        selectedFrom = moment().subtract(1, 'day').startOf('day');\n        selectedTo = moment().subtract(1, 'day').endOf('day');\n        break;\n\n      case 'thisWeek':\n        selectedFrom = moment().startOf('week');\n        selectedTo = moment().endOf('week');\n        break;\n\n      case 'previousWeek':\n        selectedFrom = moment().subtract(1, 'week').startOf('week');\n        selectedTo = moment().subtract(1, 'week').endOf('week');\n        break;\n\n      case 'thisMonth':\n        selectedFrom = moment().startOf('month');\n        selectedTo = moment().endOf('month');\n        break;\n\n      case 'previousMonth':\n        selectedFrom = moment().subtract(1, 'month').startOf('month');\n        selectedTo = moment().subtract(1, 'month').endOf('month');\n        break;\n\n      default:\n        selectedFrom = from;\n        selectedTo = to;\n        break;\n    }\n\n    const query = new URLSearchParams({\n      from: selectedFrom.toISOString(),\n      to: selectedTo.toISOString()\n    });\n    const response = await fetch(`/api/statistics?${query.toString()}`, {\n      Accept: 'application/json'\n    });\n\n    if (response.ok) {\n      setItems(await response.json());\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(FormControl, {\n    variant: \"filled\",\n    margin: \"normal\",\n    fullWidth: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(InputLabel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 9\n    }\n  }, t('reportPeriod')), /*#__PURE__*/React.createElement(Select, {\n    value: period,\n    onChange: e => setPeriod(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(MenuItem, {\n    value: \"today\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 11\n    }\n  }, t('reportToday')), /*#__PURE__*/React.createElement(MenuItem, {\n    value: \"yesterday\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 11\n    }\n  }, t('reportYesterday')), /*#__PURE__*/React.createElement(MenuItem, {\n    value: \"thisWeek\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 11\n    }\n  }, t('reportThisWeek')), /*#__PURE__*/React.createElement(MenuItem, {\n    value: \"previousWeek\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 11\n    }\n  }, t('reportPreviousWeek')), /*#__PURE__*/React.createElement(MenuItem, {\n    value: \"thisMonth\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 11\n    }\n  }, t('reportThisMonth')), /*#__PURE__*/React.createElement(MenuItem, {\n    value: \"previousMonth\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 11\n    }\n  }, t('reportPreviousMonth')), /*#__PURE__*/React.createElement(MenuItem, {\n    value: \"custom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 11\n    }\n  }, t('reportCustom')))), period === 'custom' && /*#__PURE__*/React.createElement(TextField, {\n    margin: \"normal\",\n    variant: \"filled\",\n    label: t('reportFrom'),\n    type: \"datetime-local\",\n    value: from.format(moment.HTML5_FMT.DATETIME_LOCAL),\n    onChange: e => setFrom(moment(e.target.value, moment.HTML5_FMT.DATETIME_LOCAL)),\n    fullWidth: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }\n  }), period === 'custom' && /*#__PURE__*/React.createElement(TextField, {\n    margin: \"normal\",\n    variant: \"filled\",\n    label: t('reportTo'),\n    type: \"datetime-local\",\n    value: to.format(moment.HTML5_FMT.DATETIME_LOCAL),\n    onChange: e => setTo(moment(e.target.value, moment.HTML5_FMT.DATETIME_LOCAL)),\n    fullWidth: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: handleClick,\n    fullWidth: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }\n  }, t('reportShow')));\n};\n\nconst StatisticsPage = () => {\n  const [items, setItems] = useState([]);\n  return /*#__PURE__*/React.createElement(OptionsLayout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Filter, {\n    setItems: setItems,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(TableContainer, {\n    component: Paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TableHead, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 15\n    }\n  }, t('statisticsCaptureTime')), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 15\n    }\n  }, t('statisticsActiveUsers')), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 15\n    }\n  }, t('statisticsActiveDevices')), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 15\n    }\n  }, t('statisticsRequests')), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 15\n    }\n  }, t('statisticsMessagesReceived')), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 15\n    }\n  }, t('statisticsMessagesStored')), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 15\n    }\n  }, t('notificatorMail')), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 15\n    }\n  }, t('notificatorSms')), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 15\n    }\n  }, t('statisticsGeocoder')), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 15\n    }\n  }, t('statisticsGeolocation')))), /*#__PURE__*/React.createElement(TableBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }, items.map(item => /*#__PURE__*/React.createElement(TableRow, {\n    key: item.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 17\n    }\n  }, formatDate(item.captureTime)), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 17\n    }\n  }, item.activeUsers), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 17\n    }\n  }, item.activeDevices), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 17\n    }\n  }, item.requests), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 17\n    }\n  }, item.messagesReceived), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 17\n    }\n  }, item.messagesStored), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 17\n    }\n  }, item.mailSent), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 17\n    }\n  }, item.smsSent), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 17\n    }\n  }, item.geocoderRequests), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 17\n    }\n  }, item.geolocationRequests)))))));\n};\n\nexport default StatisticsPage;","map":{"version":3,"sources":["D:/Personal_Projects/Vehicle Tracking/Development2.0/JFRD-ULTRAKER/traccar-web/modern/src/admin/StatisticsPage.js"],"names":["React","useState","FormControl","InputLabel","Select","MenuItem","TextField","Button","TableContainer","Table","TableRow","TableCell","TableHead","TableBody","Paper","moment","t","formatDate","OptionsLayout","Filter","setItems","period","setPeriod","from","setFrom","subtract","to","setTo","handleClick","selectedFrom","selectedTo","startOf","endOf","query","URLSearchParams","toISOString","response","fetch","toString","Accept","ok","json","e","target","value","format","HTML5_FMT","DATETIME_LOCAL","StatisticsPage","items","map","item","id","captureTime","activeUsers","activeDevices","requests","messagesReceived","messagesStored","mailSent","smsSent","geocoderRequests","geolocationRequests"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport {\r\n  FormControl, InputLabel, Select, MenuItem, TextField, Button, TableContainer, Table, TableRow, TableCell, TableHead, TableBody, Paper,\r\n} from '@material-ui/core';\r\nimport moment from 'moment';\r\nimport t from '../common/localization';\r\nimport { formatDate } from '../common/formatter';\r\nimport OptionsLayout from '../settings/OptionsLayout';\r\n\r\nconst Filter = ({ setItems }) => {\r\n  const [period, setPeriod] = useState('today');\r\n  const [from, setFrom] = useState(moment().subtract(1, 'hour'));\r\n  const [to, setTo] = useState(moment());\r\n\r\n  const handleClick = async () => {\r\n    let selectedFrom;\r\n    let selectedTo;\r\n    switch (period) {\r\n      case 'today':\r\n        selectedFrom = moment().startOf('day');\r\n        selectedTo = moment().endOf('day');\r\n        break;\r\n      case 'yesterday':\r\n        selectedFrom = moment().subtract(1, 'day').startOf('day');\r\n        selectedTo = moment().subtract(1, 'day').endOf('day');\r\n        break;\r\n      case 'thisWeek':\r\n        selectedFrom = moment().startOf('week');\r\n        selectedTo = moment().endOf('week');\r\n        break;\r\n      case 'previousWeek':\r\n        selectedFrom = moment().subtract(1, 'week').startOf('week');\r\n        selectedTo = moment().subtract(1, 'week').endOf('week');\r\n        break;\r\n      case 'thisMonth':\r\n        selectedFrom = moment().startOf('month');\r\n        selectedTo = moment().endOf('month');\r\n        break;\r\n      case 'previousMonth':\r\n        selectedFrom = moment().subtract(1, 'month').startOf('month');\r\n        selectedTo = moment().subtract(1, 'month').endOf('month');\r\n        break;\r\n      default:\r\n        selectedFrom = from;\r\n        selectedTo = to;\r\n        break;\r\n    }\r\n\r\n    const query = new URLSearchParams({ from: selectedFrom.toISOString(), to: selectedTo.toISOString() });\r\n    const response = await fetch(`/api/statistics?${query.toString()}`, { Accept: 'application/json' });\r\n    if (response.ok) {\r\n      setItems(await response.json());\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <FormControl variant=\"filled\" margin=\"normal\" fullWidth>\r\n        <InputLabel>{t('reportPeriod')}</InputLabel>\r\n        <Select value={period} onChange={(e) => setPeriod(e.target.value)}>\r\n          <MenuItem value=\"today\">{t('reportToday')}</MenuItem>\r\n          <MenuItem value=\"yesterday\">{t('reportYesterday')}</MenuItem>\r\n          <MenuItem value=\"thisWeek\">{t('reportThisWeek')}</MenuItem>\r\n          <MenuItem value=\"previousWeek\">{t('reportPreviousWeek')}</MenuItem>\r\n          <MenuItem value=\"thisMonth\">{t('reportThisMonth')}</MenuItem>\r\n          <MenuItem value=\"previousMonth\">{t('reportPreviousMonth')}</MenuItem>\r\n          <MenuItem value=\"custom\">{t('reportCustom')}</MenuItem>\r\n        </Select>\r\n      </FormControl>\r\n      {period === 'custom' && (\r\n        <TextField\r\n          margin=\"normal\"\r\n          variant=\"filled\"\r\n          label={t('reportFrom')}\r\n          type=\"datetime-local\"\r\n          value={from.format(moment.HTML5_FMT.DATETIME_LOCAL)}\r\n          onChange={(e) => setFrom(moment(e.target.value, moment.HTML5_FMT.DATETIME_LOCAL))}\r\n          fullWidth\r\n        />\r\n      )}\r\n      {period === 'custom' && (\r\n        <TextField\r\n          margin=\"normal\"\r\n          variant=\"filled\"\r\n          label={t('reportTo')}\r\n          type=\"datetime-local\"\r\n          value={to.format(moment.HTML5_FMT.DATETIME_LOCAL)}\r\n          onChange={(e) => setTo(moment(e.target.value, moment.HTML5_FMT.DATETIME_LOCAL))}\r\n          fullWidth\r\n        />\r\n      )}\r\n      <Button variant=\"contained\" color=\"primary\" onClick={handleClick} fullWidth>{t('reportShow')}</Button>\r\n    </>\r\n  );\r\n};\r\n\r\nconst StatisticsPage = () => {\r\n  const [items, setItems] = useState([]);\r\n\r\n  return (\r\n    <OptionsLayout>\r\n      <Filter setItems={setItems} />\r\n      <TableContainer component={Paper}>\r\n        <Table>\r\n          <TableHead>\r\n            <TableRow>\r\n              <TableCell>{t('statisticsCaptureTime')}</TableCell>\r\n              <TableCell>{t('statisticsActiveUsers')}</TableCell>\r\n              <TableCell>{t('statisticsActiveDevices')}</TableCell>\r\n              <TableCell>{t('statisticsRequests')}</TableCell>\r\n              <TableCell>{t('statisticsMessagesReceived')}</TableCell>\r\n              <TableCell>{t('statisticsMessagesStored')}</TableCell>\r\n              <TableCell>{t('notificatorMail')}</TableCell>\r\n              <TableCell>{t('notificatorSms')}</TableCell>\r\n              <TableCell>{t('statisticsGeocoder')}</TableCell>\r\n              <TableCell>{t('statisticsGeolocation')}</TableCell>\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {items.map((item) => (\r\n              <TableRow key={item.id}>\r\n                <TableCell>{formatDate(item.captureTime)}</TableCell>\r\n                <TableCell>{item.activeUsers}</TableCell>\r\n                <TableCell>{item.activeDevices}</TableCell>\r\n                <TableCell>{item.requests}</TableCell>\r\n                <TableCell>{item.messagesReceived}</TableCell>\r\n                <TableCell>{item.messagesStored}</TableCell>\r\n                <TableCell>{item.mailSent}</TableCell>\r\n                <TableCell>{item.smsSent}</TableCell>\r\n                <TableCell>{item.geocoderRequests}</TableCell>\r\n                <TableCell>{item.geolocationRequests}</TableCell>\r\n              </TableRow>\r\n            ))}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n    </OptionsLayout>\r\n  );\r\n};\r\n\r\nexport default StatisticsPage;\r\n"]},"metadata":{},"sourceType":"module"}